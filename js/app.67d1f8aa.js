(function(){"use strict";var e={3720:function(e,t,s){var i=s(9242),o=s(3396);function n(e,t){const s=(0,o.up)("router-view");return(0,o.wg)(),(0,o.j4)(s)}var r=s(89);const a={},l=(0,r.Z)(a,[["render",n]]);var u=l,c=s(2483),d=s(7139),m={__name:"GridItem",props:{item:{type:Object,required:!0},line:{type:Number,required:!0},column:{type:Number,required:!0}},setup(e){const t=e,s=(0,o.Fl)((()=>0!==t.item.value?t.item.value:t.item.notes.join())),i=(0,o.Fl)((()=>2===t.line||5===t.line)),n=(0,o.Fl)((()=>2===t.column||5===t.column)),r=(0,o.Fl)((()=>t.item.isSettled));return(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,d.C_)({grid:!0,"grid--bottom":i.value,"grid--right":n.value,"grid--setted":r.value})},(0,d.zw)(s.value),3))}};const h=(0,r.Z)(m,[["__scopeId","data-v-dc41716c"]]);var v=h;const f=["value"];var w={__name:"GridInput",props:{value:{type:[Number,String],required:!0},line:{type:Number,required:!0},column:{type:Number,required:!0}},emits:["change"],setup(e,{emit:t}){const s=e,i=(0,o.Fl)((()=>2===s.line||5===s.line)),n=(0,o.Fl)((()=>2===s.column||5===s.column)),r=e=>{const i=e.target.value.replace(/\D/g,"")||"0";let o=Number(i);Number.isNaN(o)?o=0:o>9?o=9:o<0&&(o=0),e.target.value=o,t("change",e.target.value,s.line,s.column)};return(t,s)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,d.C_)({grid:!0,"grid--bottom":i.value,"grid--right":n.value})},[(0,o._)("input",{value:e.value,onInput:r},null,40,f)],2))}};const g=(0,r.Z)(w,[["__scopeId","data-v-00529dc5"]]);var p=g;s(7658);class b{constructor(e){this.value=e,this.notes=[]}get isSettled(){return 0!==this.value}hasNotesValue(e){const t=this.notes.indexOf(e);return-1!==t}removeValueFromNotes(e){const t=this.notes.indexOf(e);return-1!==t&&(this.notes.splice(t,1),!0)}}var y=b;const k=e=>new Promise((t=>{setTimeout((()=>{t()}),e)})),S=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every(((e,s)=>e===t[s]));function N(e,t){const s=3*Math.floor(e/3),i=3*Math.floor(t/3);return{startRow:s,startColumn:i}}function C(e,t){const{startRow:s,startColumn:i}=N(e,t);return{endRow:s+2,endColumn:i+2}}const V=Object.freeze({Remove:"Remove",LastPossible:"LastPossible",HiddenSingles:"HiddenSingles",Assumption:"Assumption",BackTrack:"BackTrack"});class _{constructor(e,t){this.row=e,this.column=t}*[Symbol.iterator](){for(let s=0;s<9;s++)yield{row:this.row,column:s};for(let s=0;s<9;s++)yield{row:s,column:this.column};const{startRow:e,startColumn:t}=N(this.row,this.column);for(let s=e;s<e+3;s++)for(let e=t;e<t+3;e++)yield{row:s,column:e}}}class I{constructor(e,t){this.lNumber=e,this.cNumber=t}*[Symbol.iterator](){for(let e=0;e<this.lNumber;e++)for(let t=0;t<this.cNumber;t++)yield{row:e,column:t}}}class H{constructor(e){this.startRow=3*Math.floor(e/3),this.startColumn=e%3*3,this.endRow=this.startRow+3,this.endColumn=this.startColumn+3}*[Symbol.iterator](){for(let e=this.startRow;e<this.endRow;e++)for(let t=this.startColumn;t<this.endColumn;t++)yield{row:e,column:t}}}class F{constructor(e,t,s=!1){const{startRow:i,startColumn:o}=N(e,t),{endRow:n,endColumn:r}=C(e,t);this.startRow=s?e:i,this.startColumn=o,this.nextColumn=s?t+1:o,this.endRow=n,this.endColumn=r,this.afterCurrent=s}*[Symbol.iterator](){for(let e=this.startRow;e<=this.endRow;e++){for(let t=this.nextColumn;t<=this.endColumn;t++)yield{row:e,column:t};this.afterCurrent&&(this.nextColumn=this.startColumn)}}}const P=(e,t)=>e+t;class O{constructor(e){this.grids=e.map((e=>e.map((e=>{if("number"===typeof e)return new y(e);if(Array.isArray(e)){const t=new y(0);return t.notes=[...e],t}throw new Error("二维数组不正确")}))))}get(e,t){return this.grids[e][t]}map(e){return this.grids.map(((t,s)=>t.map(((t,i)=>e(t,s,i)))))}reduce(e,t,s,i){return this.grids.reduce(((s,o,...n)=>e(s,o.reduce(t,i),...n)),s)}unsettledItemCount(){return this.reduce(P,((e,t)=>e+(t.isSettled?0:1)),0,0)}notesTotal(){return this.reduce(P,((e,t)=>e+t.notes.length),0,0)}getNumbers(){return this.map((e=>e.isSettled?e.value:[...e.notes]))}isRowValidated(){for(let e=0;e<9;e++){const t=[...Array(9)].fill(0);for(let s=0;s<9;s++){const i=this.get(e,s),o=i.value-1;if(o>=0&&(t[o]+=1),t[o]>1)return!1}}return!0}isColumnValidated(){for(let e=0;e<9;e++){const t=[...Array(9)].fill(0);for(let s=0;s<9;s++){const i=this.get(s,e),o=i.value-1;if(o>=0&&(t[o]+=1),t[o]>1)return!1}}return!0}isGridValidated(){for(let e=0;e<9;e++){const t=[...Array(9)].fill(0),s=new H(e);for(const{row:e,column:i}of s){const s=this.get(e,i),o=s.value-1;if(o>=0&&(t[o]+=1),t[o]>1)return!1}}return!0}isValidated(){return this.isRowValidated()&&this.isColumnValidated()&&this.isGridValidated()}isCompleted(){const e=new I(9,9);for(const{row:t,column:s}of e){const e=this.get(t,s);if(!e.isSettled)return!1}return!0}isSuccess(){return this.isCompleted()&&this.isValidated()}}function x(e,t){return new Set([...e].filter((e=>!t.has(e))))}class R{constructor(e,t,s=null,i=0){this.numbers=e,this.callback=s,this.delay=i,this.listStack=[],this.itemStack=[],this.signal=t,this.gridView=new O(this.numbers)}setNumbers(e){this.numbers=e,this.gridView=new O(this.numbers)}setDelay(e){this.delay=e}reset(){this.gridView=new O(this.numbers)}isCompleted(){return this.gridView.isCompleted()}isValidated(){return this.gridView.isValidated()}isSuccess(){return this.gridView.isSuccess()}gridFor(e,t){return this.gridView.get(e,t)}async compute(){if(this.isCompleted())return;await this.lastPossibleNumber();let e=0,t=this.gridView.unsettledItemCount();while(!this.isCompleted()&&e!==t)e=t,await this.hiddenSingles(),t=this.gridView.unsettledItemCount();e=0,t=this.gridView.notesTotal();while(!this.isCompleted()&&e!==t)e=t,await this.obviousPairs(),t=this.gridView.notesTotal();await this.assumption()}async lastPossibleNumber(){const e=new I(9,9);for(const{row:t,column:s}of e){const e=this.gridFor(t,s);e.isSettled||await this.setGridNotes(t,s)}}async setGridNotes(e,t){const s=[...Array(9)].fill(0),i=new _(e,t);for(const{row:r,column:a}of i){const e=this.gridFor(r,a),t=e.value;0!==t&&(s[t-1]=1)}const o=[];s.forEach(((e,t)=>{0===e&&o.push(t+1)}));const n=this.gridFor(e,t);if(1===o.length){const s=o[0];await this.itemHaveSettled(e,t,s,V.LastPossible)}else await k(10),n.notes=o}async itemHaveSettled(e,t,s,i){this.callback?.(e,t,i,s),this.signal?.throwIfAborted(),await k(this.delay);const o=this.gridFor(e,t);o.value=s,o.notes=[];const n=new _(e,t);for(const{row:r,column:a}of n)await this.removeItemNotesValue(r,a,s)}async removeItemNotesValue(e,t,s){const i=this.gridFor(e,t);if(!i.isSettled&&i.hasNotesValue(s)&&(this.callback?.(e,t,V.Remove,s),this.signal?.throwIfAborted(),await k(this.delay),i.removeValueFromNotes(s),1===i.notes.length)){const s=i.notes[0];await this.itemHaveSettled(e,t,s,V.LastPossible)}}async hiddenSingles(){const e=new I(9,9);for(const{row:t,column:s}of e){const e=this.gridFor(t,s);e.isSettled||await this.fixItemByDifference(t,s)}}async fixItemByDifference(e,t){const s=new Set;for(let n=0;n<9;n++){const i=this.gridFor(n,t);n===e||i.isSettled||i.notes.forEach(s.add,s)}let i=await this.differenceItemNotes(e,t,s);if(i)return;s.clear();for(let n=0;n<9;n++){const i=this.gridFor(e,n);n===t||i.isSettled||i.notes.forEach(s.add,s)}if(i=await this.differenceItemNotes(e,t,s),i)return;s.clear();const o=new F(e,t);for(const{row:n,column:r}of o){const i=this.gridFor(n,r);n===e&&r===t||i.isSettled||i.notes.forEach(s.add,s)}await this.differenceItemNotes(e,t,s)}async differenceItemNotes(e,t,s){const i=this.gridFor(e,t),o=new Set([...i.notes]),n=x(o,s);if(1===n.size){const s=[...n][0];return await this.itemHaveSettled(e,t,s,V.HiddenSingles),!0}return!1}async obviousPairs(){const e=new I(9,9);for(const{row:t,column:s}of e){const e=this.gridFor(t,s);e.isSettled||2!==e.notes.length||await this.findSameNotes(t,s,e.notes)}}async findSameNotes(e,t,s){let i=1,o=s.length;const n=[t];for(let u=t+1;u<9;u++){const t=this.gridFor(e,u);if(S(t.notes,s)&&(n.push(u),i+=1,i===o)){await this.removeSameLineNotes(e,n,s);break}}i=1;const r=[e];for(let u=e+1;u<9;u++){const e=this.gridFor(u,t);if(S(e.notes,s)&&(r.push(u),i+=1,i===o)){await this.removeSameColumnNotes(t,r,s);break}}i=1;const a=[{row:e,column:t}],l=new F(e,t,!0);for(const{row:u,column:c}of l){const n=this.gridFor(u,c);if(S(n.notes,s)&&(a.push({row:u,column:c}),i+=1,i===o)){await this.removeSameGridNotes(e,t,a,s);break}}}async removeSameLineNotes(e,t,s){for(let i=0;i<9;i++)-1===t.indexOf(i)&&await this.removeItemNotesValues(e,i,s)}async removeSameColumnNotes(e,t,s){for(let i=0;i<9;i++)-1===t.indexOf(i)&&await this.removeItemNotesValues(i,e,s)}async removeSameGridNotes(e,t,s,i){const o=new F(e,t);for(const{row:n,column:r}of o){const e=s.findIndex((e=>e.row===n&&e.column===r));-1===e&&await this.removeItemNotesValues(n,r,i)}}async removeItemNotesValues(e,t,s){for(const i of s)await this.removeItemNotesValue(e,t,i)}async assumption(){await this.assumptionPush()}async assumptionPush(){const e=this.findLeastNotesGrid(),{row:t,column:s,notes:i}=e,o=i[0],n=this.gridView.getNumbers();this.listStack.push(n),this.itemStack.push({...e,index:0}),console.log("pick",t,s,o),await this.itemHaveSettled(t,s,o,V.Assumption),await this.assumptionPushOrPop()}async assumptionPushOrPop(){this.isValidated()?this.isCompleted()||await this.assumptionPush():await this.assumptionPop()}async assumptionPop(){const e=this.itemStack.pop(),t=this.listStack.pop();if(!e||!t)return;const{row:s,column:i,notes:o}=e,n=e.index+1,r=o[n];n<o.length-1&&(this.listStack.push(t),this.itemStack.push({...e,index:n})),this.gridView=new O(t),console.log("back-pick",s,i,r),await this.itemHaveSettled(s,i,r,V.BackTrack),await this.assumptionPushOrPop()}findLeastNotesGrid(){const e=new I(9,9);let t=9,s=0,i=0,o=[];for(const{row:n,column:r}of e){const e=this.gridFor(n,r);!e.isSettled&&e.notes.length<t&&(s=n,i=r,o=[...e.notes],t=e.notes.length)}return{row:s,column:i,notes:o}}}var A=R,D=s(4870);const j=e=>{let t=0;for(let s=0;s<9;s++)for(let i=0;i<9;i++){const o=e[s][i];if(o<0||o>9)return"只能输入数字 1~9";o>0&&(t+=1)}if(t<17)return"至少要确定17个数"},T=e=>((0,o.dD)("data-v-3180b858"),e=e(),(0,o.Cn)(),e),q={class:"container"},G={class:"center"},L={class:"button-container"},B={class:"content"},E={key:0,class:"setting"},Y=T((()=>(0,o._)("div",{class:"title"},"配置:",-1))),$=T((()=>(0,o._)("label",{for:"delay"},"延时(ms):",-1))),z=["value"],M={class:"input-checkbox"},K=T((()=>(0,o._)("label",{for:"last-input"},"输入时带入上一次的值",-1)));var Z={__name:"HomeView",setup(e){const t=(e,t,s,i)=>{switch(f.line=e,f.column=t,s){case V.Remove:l.value="red";break;case V.Assumption:case V.BackTrack:l.value="orange";break;default:l.value="green";break}switch(s){case V.LastPossible:n.value="唯一候选数："+i;break;case V.HiddenSingles:n.value="隐形单一数："+i;break;case V.Assumption:n.value="假定："+i;break;case V.BackTrack:n.value="回退假定："+i;break;case V.Remove:n.value="移除候选数："+i;break}r.value="black"};let s=[[3,0,0,0,0,0,9,0,0],[0,0,0,0,8,0,0,0,0],[0,0,0,0,1,0,0,0,0],[0,8,5,0,0,0,0,0,0],[0,0,0,3,0,4,7,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,7,0,0,0,1,0],[0,2,0,0,5,0,0,8,0],[4,0,0,0,0,0,3,0,0]];const n=(0,D.iH)(""),r=(0,D.iH)("black"),a=(0,D.iH)(!1),l=(0,D.iH)("transparent"),u=(0,D.iH)(!1),c=(0,D.iH)(1e3),m=(0,D.iH)(!1),h=(0,D.iH)([]),f=(0,D.qj)({line:0,column:0});let w=new AbortController;const g=localStorage.getItem("sudoku");if(g)try{s=JSON.parse(g)}catch(H){}const b=new A(s,w.signal,t,c.value),y=(0,D.iH)(b),k=e=>{e.target.value=e.target.value.replace(/\D/g,""),c.value=e.target.value;const t=Number(e.target.value);y.value.delay=Number.isNaN(t)?10:t};async function S(){if(!a.value){if(!y.value.isValidated())return n.value="输入错误，请重新输入",void(r.value="red");y.value.isSuccess()&&(n.value="完成",r.value="green"),l.value="transparent",n.value="",a.value=!0;try{await y.value.compute(),a.value=!1,y.value.isSuccess()?(n.value="完成",r.value="green"):(n.value="有错误",r.value="red")}catch(H){a.value=!1,console.log(H),n.value=H.message,r.value="red"}}}const N=()=>{w.abort(new Error("已取消")),w=new AbortController,y.value=new A(s,w.signal,t,c.value),a.value=!1,n.value="",r.value="black"},C=()=>{if(!a.value)if(u.value=!u.value,u.value)m.value?h.value=s.map((e=>[...e])):h.value=[...Array(9)].map((()=>[...Array(9)].fill(0)));else{const e=j(h.value);e?(n.value=e,r.value="red",u.value=!0):(s=h.value.map((e=>[...e])),y.value.setNumbers(s),localStorage.setItem("sudoku",JSON.stringify(s)),n.value="")}},_=()=>{n.value="",u.value=!1};function I(e,t,s){let i=Number(e);Number.isNaN(i)&&(i=0),h.value[t][s]=i}return(e,t)=>((0,o.wg)(),(0,o.iD)("div",q,[(0,o._)("div",G,[(0,o._)("div",L,[u.value?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o._)("div",{class:(0,d.C_)(["compute-button",{"compute-button--disabled":a.value}]),onClick:S}," 计算 ",2),(0,o._)("div",{class:"compute-button",onClick:N},"重置")],64)),(0,o._)("div",{class:(0,d.C_)(["compute-button",{"compute-button--disabled":a.value}]),onClick:C},(0,d.zw)(u.value?"确定":"输入"),3),u.value?((0,o.wg)(),(0,o.iD)("div",{key:1,class:"compute-button",onClick:_}," 取消 ")):(0,o.kq)("",!0)]),(0,o._)("div",B,[u.value?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:1},(0,o.Ko)(h.value,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:`line-${t}`,class:"content-line"},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,((e,s)=>((0,o.wg)(),(0,o.j4)(p,{key:`grid-${t}-${s}`,value:e,line:t,column:s,onChange:I},null,8,["value","line","column"])))),128))])))),128)):((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o._)("div",{class:"location",style:(0,d.j5)({top:60*f.line+"px",left:60*f.column+"px",borderColor:l.value,visibility:a.value?"visible":"hidden"})},null,4),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(y.value.gridView.grids,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:`line-${t}`,class:"content-line"},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,((e,s)=>((0,o.wg)(),(0,o.j4)(v,{key:`grid-${t}-${s}`,item:e,line:t,column:s},null,8,["item","line","column"])))),128))])))),128))],64))]),(0,o._)("div",{class:"message",style:(0,d.j5)({color:r.value})},(0,d.zw)(n.value),5)]),u.value?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",E,[Y,(0,o._)("div",null,[$,(0,o._)("input",{value:c.value,id:"delay",onInput:k},null,40,z)]),(0,o._)("div",M,[K,(0,o.wy)((0,o._)("input",{id:"last-input",name:"last-input",type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e)},null,512),[[i.e8,m.value]])])]))]))}};const J=(0,r.Z)(Z,[["__scopeId","data-v-3180b858"]]);var U=J;const Q=[{path:"/",name:"home",component:U}],W=(0,c.p7)({history:(0,c.PO)("/Sudoku/"),routes:Q});var X=W,ee=s(65),te=(0,ee.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,i.ri)(u).use(te).use(X).mount("#app")}},t={};function s(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i].call(n.exports,n,n.exports,s),n.exports}s.m=e,function(){var e=[];s.O=function(t,i,o,n){if(!i){var r=1/0;for(c=0;c<e.length;c++){i=e[c][0],o=e[c][1],n=e[c][2];for(var a=!0,l=0;l<i.length;l++)(!1&n||r>=n)&&Object.keys(s.O).every((function(e){return s.O[e](i[l])}))?i.splice(l--,1):(a=!1,n<r&&(r=n));if(a){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[i,o,n]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,i){var o,n,r=i[0],a=i[1],l=i[2],u=0;if(r.some((function(t){return 0!==e[t]}))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(l)var c=l(s)}for(t&&t(i);u<r.length;u++)n=r[u],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(c)},i=self["webpackChunksudoku"]=self["webpackChunksudoku"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998],(function(){return s(3720)}));i=s.O(i)})();
//# sourceMappingURL=app.67d1f8aa.js.map